<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Every great developer you know got there by solving problems they were unqualified to solve until they actually did it."><title>Java_SSL详解(二) | Just Do It</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-120855082-1','auto');ga('send','pageview');
</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Java_SSL详解(二)</h1><a id="logo" href="/.">Just Do It</a><p class="description">Every great developer you know got there by solving problems they were unqualified to solve until they actually did it.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Java_SSL详解(二)</h1><div class="post-meta">Jun 17, 2018</div><div class="post-content"><p>SSL是一个分层协议并且由4个子协议组成：</p>
<ul>
<li>SSL Handshake Protocol</li>
<li>SSL Change Cipher Spec Protocol</li>
<li>SSL Alert Protocol</li>
<li>SSL Record Layer</li>
</ul>
<p>层级关系如下图所示：</p>
<img src="/2018/Java_SSL_2/ssl_01.jpg">
<h1 id="SSL的工作方式"><a href="#SSL的工作方式" class="headerlink" title="SSL的工作方式"></a>SSL的工作方式</h1><h2 id="不需要认证客户端的SSL"><a href="#不需要认证客户端的SSL" class="headerlink" title="不需要认证客户端的SSL"></a>不需要认证客户端的SSL</h2><p>在这种场景下，客户端不需要向服务端证明自己的身份。基本上看，客户端可以是任何人，但是客户端和服务端的通信将会是保密的。在这种场景下，客户端不会有它自己的证书。它依靠服务端的证书来进行加密通讯中的消息。请注意我们不是在讨论客户端自己的用户名和密码。Web应用程序仍可能使用用户名和密码来验证用户的身份。这在目前的互联网世界是一件非常普通的事情。举个例子而言，当你访问你银行的网站的时候，并打算去登陆，此时银行并不需要你提供任何证书。下面分几步的来介绍一下当不需要客户端证书的工作步骤：</p>
<ol>
<li>服务器向客户端提供服务器证书，客户端用来验证服务器</li>
<li>客户端生成预主密钥，并使用服务器的公钥对齐进行加密（服务器的公钥是包含在证书之中的），然后将这个预主密钥发送给服务端</li>
<li>服务端使用私钥将这个预主密钥进行解密</li>
<li>客户端和服务端根据预主密钥同时计算出来一个主密钥，然后根据这个主密钥产生session keys(session keys用来进行对称加密，在这个SSL会话期内将传递的信息进行加解密并验证数据完整性).</li>
</ol>
<p>在这次握手完毕后，服务端和客户端就能以只有各自才知道的密钥进行互相通信。</p>
<h2 id="需要认证客户端的SSL"><a href="#需要认证客户端的SSL" class="headerlink" title="需要认证客户端的SSL"></a>需要认证客户端的SSL</h2><p>服务端向客户端要求提供证书，以便连接可以互相认证。客户端需要提供自己的证书并使用自己的私钥对握手消息进行签名。这个签名可以通过客户端的证书中的公钥进行验证。这样就可以表示，服务端对私钥有访问的权限。除了这一次的客户端的证书认证，剩余的步骤和上面的 “不需要认证客户端的SSL”都是一致的。在这种类型的沟通中，客户端的用户名和密码用来表示自己身份的方式就是多余的。</p>
<h2 id="简单的SSL握手图"><a href="#简单的SSL握手图" class="headerlink" title="简单的SSL握手图"></a>简单的SSL握手图</h2><p>这个图展示了简单版的，客户端和服务器之间建立每个SSL连接的步骤。</p>
<img src="/2018/Java_SSL_2/ssl_01.jpg">
<p>正如我们所见，SSL连接的达成始于交换加密参数然后（可选择）认证服务器（使用的是SSL handshake Protocol）。如果握手成功并且双方对于所使用的密码套件和加密的密钥达成一致之后，应用的数据就可以基于一个加密的通道安全的传输了。</p>
<h2 id="证书内容结构"><a href="#证书内容结构" class="headerlink" title="证书内容结构"></a>证书内容结构</h2><blockquote>
<p>为了便于理解可以先跳过这一部分，直接去看后面的章节.这里的内容引用自<a href="https://blog.wilddog.com/?p=1185" target="_blank" rel="noopener">作者：王继波 HTTPS通信中的身份认证机制</a>的文章</p>
</blockquote>
<p>现在常用的证书类型是X.509, 下面以X.509v3为例，介绍一下证书中的内容。</p>
<p>X.509v3证书由三部分组成：</p>
<ul>
<li>tbsCertificate (to be signed certificate)，待签名证书</li>
<li>SignatureAlgorithm，签名算法</li>
<li>SignatureValue，签名值</li>
</ul>
<p>tbsCertificate 包含了10项内容，在Https中握手过程中以明文方式进行传输</p>
<ul>
<li>Version Number，版本号</li>
<li>Serial Number，序列号</li>
<li>Signature Algorithm ID，签名算法ID</li>
<li>Issuer Name，发行者</li>
<li>Validity period，有效时间</li>
<li>Subject name ，证书主体名称</li>
<li>Subject Public Key Info ，证书主体公钥信息，包含公钥算法和公钥值</li>
<li>Issuer Unique Identifier (optional)，发行商唯一ID</li>
<li>Subject Unique Identifier (optional)，主体唯一ID</li>
<li>Extensions (optional)，扩展</li>
</ul>
<p>SignatureAlgorithm签名算法，eg.:(带 RSA 加密的 SHA-256),主要的使用方法就是对tbsCertificate进行哈希后获取消息摘要，再用tbsCertificate中的公钥对签名值进行解密获取摘要，将两个摘要就行比对，判断是否一致，如果一致则认为证书没有被篡改。</p>
<p>证书链的寻找过程如下图所示：</p>

<p>客户端访问服务器时，服务器首先返回签名证书，客户端根据签发者的DN往上寻找签发者CA的签名证书，签发者的签名证书会有更高一级的CA的签名证书，以此类推直到找到自签名的ROOT CA证书，看看是否已经处于truststore信任列表，如果是并且通过Public key解密签名值和所计算得出的摘要比对正确后，使用此public key继续对前一层的CA证书做同样的事情。以此类推，最终验证完毕。</p>
<h1 id="开始试验"><a href="#开始试验" class="headerlink" title="开始试验"></a>开始试验</h1><p>我们将实验的SSL握手将不需要客户端认证。所以我们将准备一个密钥对，服务器的证书。因为我们不进行客户端的认证，所以</p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="1-Java-Keytool"><a href="#1-Java-Keytool" class="headerlink" title="1.Java Keytool"></a>1.Java Keytool</h3><p>keytool 是一个私钥和证书管理的工具。它允许用户管理自己的公钥私钥对和相关的证书用于自我认证（用户向其他服务证明自己的身份），或者使用数字签名用于数据完整性校验和认证服务。它还允许用户缓存通讯对等方的公钥（以证书的形式）。Java的发行版中默认提供了这个工具，确保bin目录在你的PATH中。</p>
<h3 id="2-安装OpenSSL"><a href="#2-安装OpenSSL" class="headerlink" title="2.安装OpenSSL"></a>2.安装OpenSSL</h3><p>SSL社区已经开发了数字证书以及其管理的所有基本工具，也就是OpenSSL.我们要做的也就是去使用这个工具来设置我们的测试认证中心。OpenSSL旨在开发实现一个安全套接字层（SSL v2/v3）和传输安全层（TLS v1）协议的强大的商业级别全功能开源工具包，同时也作为一个全功能的通用加密库。可以去<a href="https://www.openssl.org/" target="_blank" rel="noopener">OpenSSL官网</a>去进行OpenSSL组件的安装。</p>
<h3 id="3-创建密钥对"><a href="#3-创建密钥对" class="headerlink" title="3.创建密钥对"></a>3.创建密钥对</h3><p>我们将使用keytool来创建密钥对。Java将私钥和证书都放入Key Store中。一个Key Store是由密码保护，且后缀名为JKS的文件。我们使用如下命令来产生一个密钥对：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -alias Deb -keystore DebKeyStore.jks -keyalg RSA -sigalg SHA1withRSA</span><br></pre></td></tr></table></figure>
<p>创建过程中使用的命令参数解释如下：</p>
<ul>
<li>genkey: 产生一个密钥对，并将产生条目放入key store文件中</li>
<li>alias: 密钥对在key store中对应的简写属性别名</li>
<li>keystore: 产生的jks文件名为DebKeyStore.jks</li>
<li>keyalg: 密钥产生算法，最常用的是RSA算法，默认的则是DSA算法</li>
<li>sigalg: 签名算法，这里“SHA1withRSA”指定的意思是使用SHA1的算法去散列摘要消息并使用RSA的私钥去进行加密。如果私钥对应的算法类型是“DSA”,那么默认的签名算法是SHA1withDSA，如果私钥的算法是”RSA“，那么默认的签名算法是”MD5withRSA”.</li>
</ul>
<p>当你运行这个命令的时候，你将会被要求输入两次密码，这两次密码分别对应不同的作用：</p>
<ol>
<li><p>Key Store Password: 你可以认为当你输入这个密码后，keytool会将这个密码放入keystore的内容体中，然后对KeyStore的内容散列/摘要产生一个签名，然后将这个签名存入keystore中。如果有人使用密码更改了这个key store文件中的内容，他也没有能力去更新摘要签名的数据。下次当你对这个key store执行keytool的命令的时候，它会发现不匹配的情况，并且警告你不匹配的情况，建议你不要再使用这个key store.</p>
</li>
<li><p>Alias Password or Private Key Password: 你将会被要求提供一个条目的密码用来保护alias所对应的条目信息，在这里这个条目的名称是Deb.在这里你可以认为这个密码是用来保护我们产生的private key.这样其它人就没有能力去阅读Deb中private key的内容。</p>
</li>
</ol>
<p>命令执行完毕后，也会要求我们提供DN的信息，在前一章中我们进行了详细的介绍。</p>
<p>为了确保密钥对正确的加入了key store，我们可以运行下面的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore DebKeyStore.jks</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">密钥库类型: JKS</span><br><span class="line">密钥库提供方: SUN</span><br><span class="line"></span><br><span class="line">您的密钥库包含 1 个条目</span><br><span class="line"></span><br><span class="line">别名: deb</span><br><span class="line">创建日期: 2018-6-17</span><br><span class="line">条目类型: PrivateKeyEntry</span><br><span class="line">证书链长度: 1</span><br><span class="line">证书[1]:</span><br><span class="line">所有者: CN=Test, OU=Test, O=Test, L=Test, ST=Test, C=Test</span><br><span class="line">发布者: CN=Test, OU=Test, O=Test, L=Test, ST=Test, C=Test</span><br><span class="line">序列号: 6fe5ac9a</span><br><span class="line">有效期开始日期: Sun Jun 17 11:10:32 CST 2018, 截止日期: Sat Sep 15 11:10:32 CST 2018</span><br><span class="line">证书指纹:</span><br><span class="line">	 MD5: 86:2F:0A:21:DF:34:F1:EB:4A:26:BC:8C:D2:02:D9:4C</span><br><span class="line">	 SHA1: 86:64:14:CA:F3:AA:E9:BF:96:F1:89:2F:0B:74:C1:0A:E2:53:54:E8</span><br><span class="line">	 SHA256: 91:D5:A7:31:B7:47:23:98:ED:95:DE:EA:40:54:50:5B:62:5E:62:5C:C4:9B:95:00:18:66:0D:7D:24:81:DE:0A</span><br><span class="line">	 签名算法名称: SHA1withRSA</span><br><span class="line">	 版本: 3</span><br><span class="line"></span><br><span class="line">扩展:</span><br><span class="line"></span><br><span class="line">#1: ObjectId: 2.5.29.14 Criticality=false</span><br><span class="line">SubjectKeyIdentifier [</span><br><span class="line">KeyIdentifier [</span><br><span class="line">0000: 31 8B EB 48 9A 37 5F 35   B0 B2 AC B6 69 4A 15 D7  1..H.7_5....iJ..</span><br><span class="line">0010: A5 90 2B 2D                                        ..+-</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*******************************************</span><br><span class="line">*******************************************</span><br></pre></td></tr></table></figure>
<p>当执行这个命令的时候，keytool会向你要求提供key store的密码来验证文件的内容的完整性。如果你不想输入密码，那么可以采用-proteced的参数，这样你可以看到key store的内容，但是无法获知完整性的校验结果。注意keytool不会打印出来私钥或者公钥，它只会告知key store中有一个私钥条目。</p>
<h3 id="4-自签名的证书"><a href="#4-自签名的证书" class="headerlink" title="4.自签名的证书"></a>4.自签名的证书</h3><p>现在我们的key store中已经有了一个私钥和一个公钥。Key Store不是一个数字证书，他只是一个保存证书和私钥的商店。现在让我们导出包含着（public key）的证书。使用下面这个命令来导出证书：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -export -alias Deb -file Deb.cer -keystore DebKeyStore.jks</span><br></pre></td></tr></table></figure>
<p>现在Deb.cer已经是一个拥有着公钥的证书。现在让我们打印这个证书的内容来看一看：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -printcert -v -file Deb.cer</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用keytool你无法导出私钥.如果想导出私钥，你需要使用Java Cryptography API.</p>
</blockquote>
<p>Deb.cer 是一个自签名的证书。他的所有者和发布者都是有着相同的DN.这个证书是由Deb的私钥来进行签名。</p>
<h3 id="5-创建一个CSR"><a href="#5-创建一个CSR" class="headerlink" title="5.创建一个CSR"></a>5.创建一个CSR</h3><p>此刻你已经拥有了一个有着密钥对的key store,即: DebKeyStore.jks 和一个包含着你的公钥的和DN信息的自签名的cer证书。但是浏览器此时还是不会信任你！只是有一个自签名的证书是不够的！为了被信任，你需要将你的证书再由CA进行签名才可以。为了做到这一点，你还需要生成一个Certificate Signing Request(CSR)，然后将这个文件发送给CA机构来进行签名。keytool产生csr文件的方式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -certreq -alias Deb -keystore DebKeyStore.jks -file Deb.csr</span><br></pre></td></tr></table></figure>
<p>上面这个命令会从jks文件中提取出来需要的信息，如公钥，DN，然后将其放入一个标准格式的csr文件中。商业CA机构在使用他们的签名签发证书之前会验证所有提供的信息。</p>
<h3 id="6-创建一个测试的CA机构"><a href="#6-创建一个测试的CA机构" class="headerlink" title="6.创建一个测试的CA机构"></a>6.创建一个测试的CA机构</h3><p>首先我们需要创建测试CA的私钥。这个是CA的高度机密，如果这个发生了泄露，那么CA就不再可信了，所有这个CA机构颁发的证书就应该被回收。对于我们的测试CA,我们需要创建密钥对并为我们的CA的公钥创建证书签名请求。请注意，这里的CSR是为了我们CA自己。这两步可以通过下面一个命令办到:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -keyout cakey.pem -out careq.pem</span><br></pre></td></tr></table></figure>
<p>每个命令参数的解释：</p>
<ul>
<li>req: 用于certificate siging requst(CSR)</li>
<li>new: 创建一个新的私钥和一个csr</li>
<li>keyout: 将private key放入文件cakey.pem.(高度机密文件)</li>
<li>out: 将CSR写入careq.pem</li>
</ul>
<p>当我们在执行命令的时候，它需要我们提供相关DN信息并需要一个密码来加密我们的private key.</p>
<blockquote>
<p>可以看到我们在上面的章节中使用keytool做了类似的事情，实际上我们也可以使用openssl来做到同样的事情。</p>
</blockquote>
<p>现在我们可以对我们上面生成过的CSR来进行签名了，显然这将是自签名的。下面的Openssl命令将根据CSR来产生一个自签名的证书。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -signkey cakey.pem -req -days 3650 -in careq.pem -out caroot.cer -extensions v3_ca</span><br></pre></td></tr></table></figure>
<ul>
<li>x509: 使用X.509证书</li>
<li>signkey: 使用cakey.pem中的私钥来生成自签名的证书</li>
<li>req: 告知input是一个CSR</li>
<li>days: 指定生成的证书的有效期</li>
<li>in: 指定输入csr文件路径</li>
<li>out: 指定输出证书的文件路径</li>
</ul>
<p>此刻我们已经CA有了一个自签名的根证书。这个证书将和私钥一道来签名其他的证书。这个根证书应该公开可用，并且必须要被浏览器和应用程序所信任。我们可以使用keytool来进行打印这个证书文件的内容.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytotol -printcert -v -file caroot.cer</span><br></pre></td></tr></table></figure>
<p>我们下一步可以手工让我们的浏览器来信任我们自己创建的CA的证书。Java运行环境将CA证书存储在 ${JAVA_HOME}/lib/security/cacerts文件中。这是一个keystore文件，我们可以使用keytool命令来查看其中的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -protected -keystore cacerts</span><br></pre></td></tr></table></figure>
<p>我们也可以将这个CA证书加入cacerts文件中， caerts的keystore文件的默认密码是”changeit”.我们也可以将这个Test CA证书添加进入我们的DebKeyStore.jks文件中，在运行时指向这个key store,以便我信任们使用这个CA颁发的证书。</p>
<h3 id="7-使我们创建的证书被我们创建的CA所签名"><a href="#7-使我们创建的证书被我们创建的CA所签名" class="headerlink" title="7.使我们创建的证书被我们创建的CA所签名"></a>7.使我们创建的证书被我们创建的CA所签名</h3><p>现在Test CA已经准备完毕，我们也已经将其假如我们浏览器信任的truststore.现在是时候使用这个CA证书来签名我们前面创建的签名证书了。然而，在CA在进行颁发一个证书的时候，需要写一串序列号进行这个证书里面去，所以你需要告诉Openssl下一个序列号应该使用什么值。所以我们需要创建一个serial.txt来包含序列号的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo 1234&gt;serial.txt</span><br><span class="line">openssl x509 -CA caroot.cer -CAkey cakey.pem -CAserial serial.txt -req -in Deb.csr -out DebTestCA.cer -days 365</span><br></pre></td></tr></table></figure>
<h3 id="8-Java中导入CA证书和被CA签名的证书"><a href="#8-Java中导入CA证书和被CA签名的证书" class="headerlink" title="8.Java中导入CA证书和被CA签名的证书"></a>8.Java中导入CA证书和被CA签名的证书</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">keytool -import -alias TestCA -file caroot.cer -keystore DebKeyStore.jks</span><br><span class="line"></span><br><span class="line">keytool -list -v -keystore DebKeyStore.jks</span><br><span class="line"></span><br><span class="line">密钥库类型: JKS</span><br><span class="line">密钥库提供方: SUN</span><br><span class="line"></span><br><span class="line">您的密钥库包含 2 个条目</span><br><span class="line"></span><br><span class="line">别名: deb</span><br><span class="line">创建日期: 2018-6-17</span><br><span class="line">条目类型: PrivateKeyEntry</span><br><span class="line">证书链长度: 2</span><br><span class="line">证书[1]:</span><br><span class="line">所有者: CN=Test, OU=Test, O=Test, L=Test, ST=Test, C=Test</span><br><span class="line">发布者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">序列号: 1235</span><br><span class="line">有效期开始日期: Sun Jun 17 16:42:11 CST 2018, 截止日期: Mon Jun 17 16:42:11 CST 2019</span><br><span class="line">证书指纹:</span><br><span class="line">	 MD5: 06:CB:4C:DB:6B:D2:39:A1:B3:C2:54:27:87:4E:76:A7</span><br><span class="line">	 SHA1: 29:1F:DF:15:06:FA:C5:2E:EC:FE:E7:18:C1:0B:28:E4:53:25:A2:54</span><br><span class="line">	 SHA256: 85:E5:DC:C1:01:DE:C8:9D:4A:07:F6:60:EF:4F:4D:E9:2C:DD:C3:D7:E1:13:F8:E4:51:7B:77:F2:0C:EA:82:73</span><br><span class="line">	 签名算法名称: SHA1withRSA</span><br><span class="line">	 版本: 1</span><br><span class="line">证书[2]:</span><br><span class="line">所有者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">发布者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">序列号: ecec5d0c5300b823</span><br><span class="line">有效期开始日期: Sun Jun 17 16:37:54 CST 2018, 截止日期: Wed Jun 14 16:37:54 CST 2028</span><br><span class="line">证书指纹:</span><br><span class="line">	 MD5: AD:48:CB:E8:19:31:DF:B4:BD:DF:94:C1:FF:4E:88:4D</span><br><span class="line">	 SHA1: A9:DA:E3:1A:47:6B:71:70:80:65:73:B9:02:FA:CF:77:26:ED:93:74</span><br><span class="line">	 SHA256: 44:A3:21:9A:40:A6:97:81:88:DF:3A:A4:56:F4:B3:85:F7:94:84:00:B4:B3:9E:76:12:1A:97:54:75:2E:D5:50</span><br><span class="line">	 签名算法名称: SHA1withRSA</span><br><span class="line">	 版本: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*******************************************</span><br><span class="line">*******************************************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">别名: testca</span><br><span class="line">创建日期: 2018-6-17</span><br><span class="line">条目类型: trustedCertEntry</span><br><span class="line"></span><br><span class="line">所有者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">发布者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">序列号: ecec5d0c5300b823</span><br><span class="line">有效期开始日期: Sun Jun 17 16:37:54 CST 2018, 截止日期: Wed Jun 14 16:37:54 CST 2028</span><br><span class="line">证书指纹:</span><br><span class="line">	 MD5: AD:48:CB:E8:19:31:DF:B4:BD:DF:94:C1:FF:4E:88:4D</span><br><span class="line">	 SHA1: A9:DA:E3:1A:47:6B:71:70:80:65:73:B9:02:FA:CF:77:26:ED:93:74</span><br><span class="line">	 SHA256: 44:A3:21:9A:40:A6:97:81:88:DF:3A:A4:56:F4:B3:85:F7:94:84:00:B4:B3:9E:76:12:1A:97:54:75:2E:D5:50</span><br><span class="line">	 签名算法名称: SHA1withRSA</span><br><span class="line">	 版本: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*******************************************</span><br><span class="line">*******************************************</span><br></pre></td></tr></table></figure>
<p>分析一下上面的打印信息，我们可以发现这里就是一条证书链。也就是当我们进行服务端的身份验证的时候，根据证书1，我们发现发布者为“<a href="mailto:EMAILADDRESS=fantasycool@126.com" target="_blank" rel="noopener">EMAILADDRESS=fantasycool@126.com</a>, CN=test, OU=test, O=test, L=test, ST=test, C=zh”，说明我们这个证书被一个CA所签名认证，那我们就向上寻找所有者为“<a href="mailto:EMAILADDRESS=fantasycool@126.com" target="_blank" rel="noopener">EMAILADDRESS=fantasycool@126.com</a>, CN=test, OU=test, O=test, L=test, ST=test, C=zh”的签名证书，结果找到了所有者和发布者相同的签名证书，说明此时已经为最上层的根证书了，假如我们此时已经信任了这个根证书，那么就可以反向沿着证书链来不断重新生成消息摘要，比对签名值来进行验证，以此类推。</p>
<h3 id="9-准备好程序所有需要的key-store文件"><a href="#9-准备好程序所有需要的key-store文件" class="headerlink" title="9.准备好程序所有需要的key store文件"></a>9.准备好程序所有需要的key store文件</h3><p>在前面我们创造的DevKeyStore.jks,里面包含了私钥和证书，现在我们会使用这个DevKeyStore.jks来作为我们的服务端key store,拷贝重命名为ServerKeyStore.jks.虽然我们不需要客户端的证书认证，但是我们仍然需要为请求的客户端准备一个keystore,用来添加Test CA’s的根证书。因为如果我们是通过浏览器来访问，可以通过手工添加证书到浏览器来做到信任。但是假如通过Java程序来访问，我们则需要在程序中信任配置这个根证书。使用下面这个命令来创建ClientKeyStore.jks.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">keytool -import -keystore ClientKeyStore.jks -alias testca -file caroot.cer</span><br><span class="line"></span><br><span class="line">输入密钥库口令:</span><br><span class="line">再次输入新口令:</span><br><span class="line">所有者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">发布者: EMAILADDRESS=fantasycool@126.com, CN=test, OU=test, O=test, L=test, ST=test, C=zh</span><br><span class="line">序列号: ecec5d0c5300b823</span><br><span class="line">有效期开始日期: Sun Jun 17 16:37:54 CST 2018, 截止日期: Wed Jun 14 16:37:54 CST 2028</span><br><span class="line">证书指纹:</span><br><span class="line">	 MD5: AD:48:CB:E8:19:31:DF:B4:BD:DF:94:C1:FF:4E:88:4D</span><br><span class="line">	 SHA1: A9:DA:E3:1A:47:6B:71:70:80:65:73:B9:02:FA:CF:77:26:ED:93:74</span><br><span class="line">	 SHA256: 44:A3:21:9A:40:A6:97:81:88:DF:3A:A4:56:F4:B3:85:F7:94:84:00:B4:B3:9E:76:12:1A:97:54:75:2E:D5:50</span><br><span class="line">	 签名算法名称: SHA1withRSA</span><br><span class="line">	 版本: 1</span><br><span class="line">是否信任此证书? [否]:  是</span><br><span class="line">证书已添加到密钥库中</span><br></pre></td></tr></table></figure>
<p>最后，贴上Java的示例代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.frio.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLServerSocket;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLServerSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * EchoServer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EchoServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.setProperty(<span class="string">"javax.net.ssl.keyStore"</span>, <span class="string">"/tmp/ServerKeyStore.jks"</span>);</span><br><span class="line">        System.setProperty(<span class="string">"javax.net.ssl.keyStorePassword"</span>, <span class="string">"111111"</span>);</span><br><span class="line"></span><br><span class="line">        System.setProperty(<span class="string">"javax.net.debug"</span>, <span class="string">"ssl:record"</span>);</span><br><span class="line"></span><br><span class="line">        EchoServer server = <span class="keyword">new</span> EchoServer();</span><br><span class="line">        server.startServer();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startServer</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ServerSocketFactory ssf = SSLServerSocketFactory.getDefault();</span><br><span class="line">        SSLServerSocket serverSocket = (SSLServerSocket)ssf.createServerSocket(<span class="number">8282</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            Socket client = serverSocket.accept();</span><br><span class="line">            <span class="keyword">new</span> ProcessRequest(client);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * InnerEchoServer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProcessRequest</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">        Socket client;</span><br><span class="line">        BufferedReader is;</span><br><span class="line">        DataOutputStream out;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ProcessRequest</span><span class="params">(Socket s)</span></span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.client = s;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                is = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(client.getInputStream()));</span><br><span class="line">                out = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">            &#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                String request = is.readLine();</span><br><span class="line">                System.out.println(<span class="string">"Received from client:"</span> + request);</span><br><span class="line">                out.writeBytes(<span class="string">"HTTP/1.0 200 OK\r\n"</span>);</span><br><span class="line">                out.writeBytes(<span class="string">"Content-Type: text/html\r\n"</span>);</span><br><span class="line">                out.writeBytes(<span class="string">"ok:"</span>+request);</span><br><span class="line">                out.flush();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">					client.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.frio.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocket;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * EchoClient</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EchoClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.setProperty(<span class="string">"javax.net.ssl.trustStore"</span>, <span class="string">"/tmp/ClientKeyStore.jks"</span>);</span><br><span class="line">        System.setProperty(<span class="string">"java.net.debug"</span>, <span class="string">"ssl:record"</span>);</span><br><span class="line"></span><br><span class="line">        SSLSocketFactory f = (SSLSocketFactory) SSLSocketFactory.getDefault();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            SSLSocket c = (SSLSocket)f.createSocket(<span class="string">"localhost"</span>, <span class="number">8282</span>);</span><br><span class="line">            c.startHandshake();</span><br><span class="line">            </span><br><span class="line">            BufferedWriter w = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(c.getOutputStream()));</span><br><span class="line">            BufferedReader r = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(c.getInputStream()));</span><br><span class="line">            </span><br><span class="line">            String message = <span class="string">"Hey, here is the client, how are you!"</span>;</span><br><span class="line">            w.write(message, <span class="number">0</span>, message.length());</span><br><span class="line">            w.newLine();</span><br><span class="line">            w.flush();</span><br><span class="line"></span><br><span class="line">            String m = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">while</span>((m = r.readLine()) != <span class="keyword">null</span>)&#123;</span><br><span class="line">                System.out.println(m);</span><br><span class="line">            &#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文汇总翻译<a href="https://sites.google.com/site/ddmwsst/create-your-own-certificate-and-ca/ssl-socket-communication" target="_blank" rel="noopener">SSL Socket Communication</a>和<a href="https://sites.google.com/site/ddmwsst/create-your-own-certificate-and-ca" target="_blank" rel="noopener">Create Your Own Certificate and CA</a></p>
</blockquote>
</div><div class="tags"><a href="/tags/Java/">Java</a><a href="/tags/SSL/">SSL</a><a href="/tags/Openssl/">Openssl</a><a href="/tags/KeyStore/">KeyStore</a></div><div class="post-nav"><a class="pre" href="/2018/gnu_make_scatch_1/">GNU make使用手册</a><a class="next" href="/2018/Java_SSL_1/">Java_SSL详解(一)</a></div><div id="container"></div><link rel="stylesheet" href="/css/default.css?v=0.0.0"><script src="/js/gitment.browser.js?v=0.0.0"></script><script>var gitment = new Gitment({
  owner: 'geek-frio',
  repo: 'geek-frio.github.io',
  oauth: {
    client_id: 'c932c463c47bd6dfa128',
    client_secret: '75354bbd7b056095ef7e38e05fc72b6a9a9bbec7',
  },
})
gitment.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.geekiknow.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/SSL/" style="font-size: 15px;">SSL</a> <a href="/tags/Openssl/" style="font-size: 15px;">Openssl</a> <a href="/tags/KeyStore/" style="font-size: 15px;">KeyStore</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/GNU/" style="font-size: 15px;">GNU</a> <a href="/tags/make/" style="font-size: 15px;">make</a> <a href="/tags/C/" style="font-size: 15px;">C</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/gnu_make_scatch_1/">GNU make使用手册</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/Java_SSL_2/">Java_SSL详解(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/Java_SSL_1/">Java_SSL详解(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/nginx_config/">Nginx配置文件全剖析</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Just Do It.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>